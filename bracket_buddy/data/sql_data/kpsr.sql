select * from kenpom_master;
select * from SR_all_games;
select * from SR_KP_map;
select count(s.sportsref_id) as `records`, s.home_team from SR_all_games s GROUP BY s.home_team ORDER BY `records` desc;

select count(s.sportsref_id) as `records`, s.away_team FROM SR_all_games s GROUP BY s.away_team ORDER BY `records` desc;

select s.away_team FROM SR_all_games s LEFT JOIN SR_KP_map k ON s.away_team = k.SR_name WHERE k.`SR_name` IS NULL GROUP BY s.away_team;

select DISTINCT KPTeamName from kenpom_master km LEFT JOIN SR_KP_map k ON k.KP_name=km.KPTeamName WHERE k.KP_name IS NULL;

select k.KP_name FROM kenpom_master km RIGHT JOIN SR_KP_map k ON k.KP_name=km.KPTeamName WHERE km.KPTeamName IS NULL;

select sra.away_team, sra.home_team, km.`KPTeamName` as `KP_home`, km.`Season` as `hSeason`, km.`AdjTempo` as `hAdjTempo`, km.`AdjDE` as `hAdjOE`, km.`eFG_Pct_O` as `heFG_Pct_O`, km.`eFG_Pct_D` as `heFG_Pct_D`, km.`TO_Pct_O` as `hTO_Pct_O`, km.`TO_Pct_D` as `hTO_Pct_D`, km.`OR_Pct_O` as `hOR_Pct_O`, km.`OR_Pct_D` as `hOR_Pct_D`, km.`FT_Rate_O` as `hFT_Rate_O`, km.`FT_Rate_D` as `hFT_Rate_D`, km.`OFF_FT` as `hOFF_FT`, km.`OFF_2PT` as `hOFF_2PT`, km.`OFF_3PT` as `hOFF_3PT`, km.`DEF_FT` as `hDEF_FT`, km.`DEF_2PT` as `hDEF_2PT`, km.`DEF_3PT` as `hDEF_3PT`, km.`Size` as `hSize`, km.`Hgt1` as `hHgt1`, km.`Hgt2` as `hHgt2`, km.`Hgt3` as `hHgt3`, km.`Hgt4` as `hHgt4`, km.`Hgt5` as `hHgt5`, km.`HgtEff` as `hHgtEff`, km.`Exp` as `hExp`, km.`Bench` as `hBench`, km.`Pts1` as `hPts1`, km.`Pts2` as `hPts2`, km.`Pts3` as `hPts3`, km.`Pts4` as `hPts4`, km.`Pts5` as `hPts5`, km.`OR1` as `hOR1`, km.`OR2` as `hOR2`, km.`OR3` as `hOR3`, km.`OR4` as `hOR4`, km.`OR5` as `hOR5`, km.`DR1` as `hDR1`, km.`DR2` as `hDR2`, km.`DR3` as `hDR3`, km.`DR4` as `hDR4`, km.`DR5` as `hDR5`, km.`FG2Pct` as `hFG2Pct`, km.`FG3Pct` as `hFG3Pct`, km.`FTPct` as `hFTPct`, km.`BlockPct` as `hBlockPct`, km.`OppFG2Pct` as `hOppFG2Pct`, km.`OppFG3Pct` as `hOppFG3Pct`, km.`OppFTPct` as `hOppFTPct`, km.`OppBlockPct` as `hOppBlockPct`, km.`F3GRate` as `hF3GRate`,  km.`OppF3GRate` as `hOppF3GRate`, km.`ARate` as `hARate`, km.`OppARate` as `hOppARate`, km.`StlRate` as `hStlRate`, km.`OppStlRate` as `hOppStlRate`, kp.`KPTeamName` as `KP_home`, kp.`Season` as `aSeason`, kp.`AdjTempo` as `aAdjTempo`, kp.`AdjDE` as `aAdjOE`, kp.`eFG_Pct_O` as `aeFG_Pct_O`, kp.`eFG_Pct_D` as `aeFG_Pct_D`, kp.`TO_Pct_O` as `aTO_Pct_O`, kp.`TO_Pct_D` as `aTO_Pct_D`, kp.`OR_Pct_O` as `aOR_Pct_O`, kp.`OR_Pct_D` as `aOR_Pct_D`, kp.`FT_Rate_O` as `aFT_Rate_O`, kp.`FT_Rate_D` as `aFT_Rate_D`, kp.`OFF_FT` as `aOFF_FT`, kp.`OFF_2PT` as `aOFF_2PT`, kp.`OFF_3PT` as `aOFF_3PT`, kp.`DEF_FT` as `aDEF_FT`, kp.`DEF_2PT` as `aDEF_2PT`, kp.`DEF_3PT` as `aDEF_3PT`, kp.`Size` as `aSize`, kp.`Hgt1` as `aHgt1`, kp.`Hgt2` as `aHgt2`, kp.`Hgt3` as `aHgt3`, kp.`Hgt4` as `aHgt4`, kp.`Hgt5` as `aHgt5`, kp.`HgtEff` as `aHgtEff`, kp.`Exp` as `aExp`, kp.`Bench` as `aBench`, kp.`Pts1` as `aPts1`, kp.`Pts2` as `aPts2`, kp.`Pts3` as `aPts3`, kp.`Pts4` as `aPts4`, kp.`Pts5` as `aPts5`, kp.`OR1` as `aOR1`, kp.`OR2` as `aOR2`, kp.`OR3` as `aOR3`, kp.`OR4` as `aOR4`, kp.`OR5` as `aOR5`, kp.`DR1` as `aDR1`, kp.`DR2` as `aDR2`, kp.`DR3` as `aDR3`, kp.`DR4` as `aDR4`, kp.`DR5` as `aDR5`, kp.`FG2Pct` as `aFG2Pct`, kp.`FG3Pct` as `aFG3Pct`, kp.`FTPct` as `aFTPct`, kp.`BlockPct` as `aBlockPct`, kp.`OppFG2Pct` as `aOppFG2Pct`, kp.`OppFG3Pct` as `aOppFG3Pct`, kp.`OppFTPct` as `aOppFTPct`, kp.`OppBlockPct` as `aOppBlockPct`, kp.`F3GRate` as `aF3GRate`,  kp.`OppF3GRate` as `aOppF3GRate`, kp.`ARate` as `aARate`, kp.`OppARate` as `aOppARate`, kp.`StlRate` as `aStlRate`, kp.`OppStlRate` as `aOppStlRate`
FROM kenpom_master kp RIGHT JOIN SR_KP_map am ON kp.`KPTeamName` = am.`KP_name` RIGHT JOIN `SR_all_games` sra ON am.SR_name = sra.away_team AND kp.Season = sra.year LEFT JOIN `SR_KP_map` hm ON sra.home_team = hm.SR_name LEFT JOIN kenpom_master km ON km.`KPTeamName`=hm.KP_name AND sra.year=km.Season; 
 

